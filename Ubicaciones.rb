require 'csv'
require 'json'
require 'Geocoder'

class Ubicaciones
	def ubicame(ac)
	  _distrito = "locality"
	  _canton = "administrative_area_level_2"
	  _provincia = "administrative_area_level_1"
	  provincia,canton,distrito = nil 
	  ac.each do |_ac|
		distrito = _ac["short_name"] if _ac["types"].include?(_distrito)
		canton = _ac["short_name"] if _ac["types"].include?(_canton)
		provincia = _ac["short_name"] if _ac["types"].include?(_provincia)
	  end
	  distrito = provincia if distrito.nil?
	  canton = distrito if canton.nil?
	  return provincia, canton, distrito
	end

	def fetch(idx, file_number)
		puts "Processing batch #{file_number} with idx #{idx}..."
		# load arr with lat/long
		arr = [[9.933,-84.032], [9.91,-84.068], [9.977,-84.085], [9.914,-84.034], [9.923,-84.024], [9.907,-84.063], [9.905,-84.05], [9.9953,-84.0441], [9.901,-84.07], [9.8954,-84.0645], [9.895,-84.046], [9.917,-84.101], [9.891,-84.065], [10.006,-84.05], [9.908,-84.109], [9.903,-84.106], [9.886,-84.082], [9.918,-83.996], [9.8857,-84.0841], [9.8833,-84.0781], [9.8954,-84.0124], [9.8826,-84.0836], [10.02,-84.07], [9.9,-84], [9.906,-84.119], [9.871,-84.069], [9.8759,-84.0141], [9.865,-84.07], [9.9671,-83.9745], [9.893,-84.123], [9.8617,-84.0537], [9.8863,-84.1196], [9.971,-83.9712], [10.007,-83.99], [9.91,-84.141], [10.018,-83.995], [9.936,-84.151], [9.855,-84.0307], [9.9629,-84.1523], [9.952,-84.154], [9.853,-84.104], [9.896,-84.155], [9.842,-84.014], [9.8357,-84.0266], [9.843,-84.006], [9.9167,-84.169], [9.841,-84.006], [9.844,-84], [9.839,-84.01], [9.851,-83.984], [9.834,-84.014], [9.835,-84.01], [9.9,-84.17], [9.8284,-84.0261], [9.8985,-84.1705], [9.8244,-84.0451], [9.823,-84.048], [9.9249,-84.1804], [10.073,-84.041], [9.827,-84.018], [9.932,-84.183], [9.9137,-84.1802], [9.831,-83.999], [10.079,-84.04], [9.828,-83.9992], [9.844,-83.973], [9.828,-83.998], [9.87,-83.947], [9.9855,-84.1865], [9.898,-83.93], [9.89,-84.18], [10.083,-84.0783], [10.085,-84.035], [9.927,-84.194], [9.895,-83.925], [9.892,-83.925], [9.916,-84.198], [10.0627,-83.9652], [9.817,-83.99], [10.09,-84.013], [10.0442,-83.9411], [9.8993,-84.1998], [10.0621,-83.9565], [10.0453,-83.9396], [9.8162,-83.9806], [9.862,-83.931], [9.8773,-83.9217], [9.893,-84.1993], [9.897,-84.201], [9.9001,-84.2021], [10.0977,-84.0179], [9.886,-83.915], [9.848,-84.175], [9.802,-84.109], [9.94,-83.9], [9.7988,-84.006], [9.797,-84.01], [9.8,-84], [9.83,-83.95], [10.069,-84.16], [10.079,-83.966], [10.1,-84.11], [9.7895,-84.0883], [9.8077,-83.9763], [9.8007,-83.9898], [9.8057,-83.9752], [9.885,-83.905], [9.791,-84.007], [9.8896,-84.2112], [9.8996,-84.2149], [9.8918,-84.2125], [9.974,-83.893], [9.7995,-83.9827], [9.793,-83.994], [10.1145,-84.0785], [9.8146,-83.9545], [9.8203,-83.9466], [9.98,-83.889], [9.804,-83.9617], [9.893,-83.893], [9.875,-83.9], [9.9576,-83.8837], [9.794,-83.976], [9.795,-83.974], [9.9569,-83.8826], [9.961,-83.882], [9.7796,-84.0083], [9.7807,-84.0032], [9.968,-83.882], [9.791,-83.977], [9.7953,-83.9686], [9.9704,-83.8815], [10.0274,-84.2146], [9.96,-83.88], [9.7814,-83.9963], [9.963,-83.88], [9.967,-84.233], [9.789,-83.978], [9.9658,-83.8799], [9.954,-83.879], [9.784,-83.984], [9.959,-83.877], [9.79,-83.97], [9.884,-83.888], [9.9459,-83.8752], [9.94,-83.875], [9.8088,-83.9388], [9.965,-83.875], [9.799,-83.951], [9.9541,-83.8731], [9.9686,-83.8741], [10.13,-84.09], [9.795,-83.951], [9.884,-83.882], [9.799,-84.168], [9.79,-83.958], [9.817,-83.923], [9.8904,-83.8785], [9.763,-84.028], [9.905,-83.874], [9.9586,-83.8691], [9.762,-84.028], [9.7603,-84.0425], [9.7899,-83.9538], [9.903,-83.873], [9.98,-83.87], [9.764,-84.012], [9.9585,-83.8674], [9.9818,-83.8674], [9.756,-84.04], [9.787,-83.95], [9.9658,-83.8642], [9.894,-83.871], [9.7609,-84.0075], [9.9568,-83.8631], [9.76,-84.01], [9.962,-84.25], [9.962,-84.25], [9.9491,-83.8619], [9.972,-83.863], [9.8376,-83.8947], [9.9556,-83.86], [9.8335,-83.8957], [9.976,-83.861], [9.782,-83.949], [9.781,-83.948], [9.9494,-83.8567], [10.1187,-84.161], [9.953,-83.856], [9.9661,-83.8561], [9.7688,-83.9633], [9.9646,-83.8538], [9.983,-83.856], [9.96,-83.853], [9.9514,-83.8524], [9.9592,-83.8512], [9.805,-83.906], [9.81,-83.901], [9.9534,-83.8485], [10.09,-84.21], [9.797,-83.912], [10.085,-84.215], [9.976,-83.847], [9.736,-84.067], [9.8087,-83.8955], [9.794,-83.909], [9.956,-83.843], [10.15,-84.13], [9.9957,-84.2663], [9.9755,-83.8434], [9.996,-83.847], [10.021,-83.854], [9.805,-83.8938], [9.987,-83.843], [9.793,-83.9039], [9.793,-83.9039], [9.9899,-83.8424], [10.156,-83.99], [9.8032,-84.221], [9.799,-83.896], [9.95,-83.837], [9.7905,-83.9033], [10.1558,-83.9844], [9.91,-83.84], [9.9528,-83.8367], [10.081,-84.232], [9.953,-83.836], [9.974,-83.837], [10.1444,-84.1598], [9.8072,-83.8851], [9.978,-83.836], [9.959,-83.834], [10.131,-83.929], [9.7924,-83.8966], [9.967,-83.834], [9.975,-83.834], [9.969,-83.833], [9.7414,-83.9668], [10.037,-83.849], [9.7679,-83.9201], [9.974,-83.831], [9.965,-83.83], [9.93,-83.83], [9.735,-83.975], [9.8,-83.883], [9.965,-83.828], [9.7902,-83.8899], [9.7868,-83.8927], [9.7973,-83.8828], [9.928,-83.827], [10.016,-84.277], [9.9734,-83.8274], [9.821,-83.862], [10.167,-83.976], [9.972,-83.824], [9.7828,-83.8908], [9.816,-83.863], [9.82,-83.859], [9.7376,-83.9487], [9.793,-83.878], [9.7445,-83.9348], [10.152,-84.178], [9.787,-83.881], [10.173,-83.977], [9.9587,-83.8182], [9.979,-83.819], [9.809,-83.861], [10.1514,-84.1857], [10.141,-84.201], [10.147,-83.92], [10.1607,-84.1709], [9.8398,-84.2727], [10.1506,-84.1899], [9.7482,-83.9193], [10.173,-84.151], [9.97,-83.81], [10.188,-84.118], [10.167,-83.936], [10.193,-84.116], [9.9693,-83.8047], [10.18,-84.158], [9.977,-83.805], [10.0029,-83.8091], [10.184,-83.963], [9.9802,-83.8047], [9.9583,-83.8024], [9.7459,-83.9], [9.7402,-83.9063], [9.8004,-84.2665], [10.1694,-84.1865], [9.95,-83.8], [10.188,-84.149], [10.0965,-84.2668], [9.76,-83.88], [10.192,-84.145], [9.945,-83.797], [10.147,-84.224], [9.948,-83.7931], [9.94,-83.793], [9.8712,-84.309], [9.919,-83.794], [9.684,-84.068], [9.741,-83.892], [9.9739,-83.7933], [9.9643,-83.7924], [10.208,-84.108], [10.206,-84.1185], [10.183,-84.181], [10.197,-83.963], [9.752,-83.876], [10.2024,-84.137], [9.776,-84.261], [10.205,-84.132], [9.775,-83.851], [9.7673,-84.2556], [9.796,-84.279], [9.6931,-83.9685], [9.742,-83.881], [10.136,-84.253], [9.76,-83.857], [9.857,-83.795], [9.6889,-84.1577], [9.71,-83.911], [10.1515,-84.2505], [9.8956,-84.3329], [9.6678,-84.0205], [9.686,-84.165], [9.969,-83.773], [9.6829,-84.161], [9.67,-84.12], [9.7027,-83.9077], [9.7008,-83.9108], [9.6822,-84.1658], [10.231,-84.002], [10.2358,-84.0228], [9.6737,-84.1531], [10.215,-83.94], [10.1774,-84.2383], [9.8446,-84.3307], [9.655,-84.057], [10.1789,-84.2386], [10.027,-83.773], [9.743,-84.269], [9.889,-84.347], [10.1734,-84.2496], [9.8043,-84.3165], [9.788,-83.806], [9.839,-84.334], [9.782,-83.809], [9.684,-84.197], [10.188,-84.236], [10.0294,-83.7682], [9.6488,-84.0344], [10.24,-83.983], [10.2044,-84.215], [9.7474,-84.282], [10.197,-84.23], [9.65,-84], [9.666,-84.172], [9.8062,-83.7861], [10.008,-83.757], [10.203,-84.229], [9.6922,-84.2282], [10.171,-83.843], [9.64,-84.02], [10.205,-84.231], [10.203,-84.234], [9.933,-83.744], [10.203,-84.239], [10.199,-84.247], [9.845,-84.356], [9.66,-84.19], [9.66,-84.19], [9.63,-84.06], [10.2001,-84.2512], [10.182,-84.273], [10.266,-84.028], [9.631,-84.103], [9.6932,-83.8606], [9.9582,-84.3787], [9.949,-83.734], [9.743,-83.805], [10.169,-84.296], [9.844,-84.366], [9.6309,-84.1357], [10.244,-84.205], [10.237,-84.219], [9.631,-83.953], [9.7257,-83.8072], [9.717,-83.814], [9.975,-83.722], [9.647,-84.209], [9.863,-84.385], [10.144,-84.334], [9.638,-84.205], [9.672,-83.851], [10.193,-84.3], [10.237,-84.246], [9.708,-83.807], [9.636,-84.207], [10.179,-83.792], [10.265,-84.219], [10.2243,-84.2825], [9.5917,-84.087], [9.784,-84.375], [9.5899,-84.0389], [10.297,-84.1403], [10.275,-84.208], [10.245,-84.265], [9.596,-84.146], [9.584,-83.999], [9.6706,-83.8112], [10.1398,-84.3762], [9.603,-83.913], [9.6505,-83.8304], [9.5852,-83.9638], [9.8952,-83.6858], [10.207,-83.784], [9.576,-83.996], [9.579,-84.142], [10.211,-83.782], [10.3207,-84.1337], [10.1647,-83.7393], [10.079,-84.419], [9.5677,-84.1288], [9.6955,-84.3528], [10.268,-83.835], [9.566,-84.139], [9.562,-84.139], [10.215,-84.349], [10.1916,-83.7404], [9.5465,-84.0504], [9.591,-84.244], [9.546,-84.106], [9.5612,-84.1834], [10.21,-84.37], [9.549,-84.152], [9.5489,-84.155], [9.5534,-83.9408], [9.9296,-83.6454], [9.5829,-83.8656], [9.54,-84.12], [9.92,-83.643], [10.284,-84.302], [9.864,-83.648], [9.53,-84.07], [9.8925,-84.4715], [9.684,-83.728], [9.5638,-84.231], [9.533,-84.133], [10.255,-84.349], [9.541,-84.18], [9.53,-84.14], [9.55,-84.21], [10.238,-84.375], [10.234,-84.38], [10.252,-84.365], [10.235,-84.381], [9.52,-84.13], [10.2395,-84.3797], [9.5238,-84.1539], [10.252,-84.369], [10.3134,-84.2947], [9.5747,-83.8261], [10.262,-84.367], [10.262,-84.367], [9.5356,-83.8906], [9.51,-84.14], [10.252,-84.383], [9.54,-84.245], [10.2722,-84.3706], [10.353,-84.256], [9.508,-83.945], [9.5487,-84.2781], [9.586,-83.777], [10.2754,-84.3788], [9.506,-84.185], [9.5003,-84.1703], [10.342,-84.298], [10.354,-84.278], [9.5344,-83.8462], [9.482,-84.053], [9.9727,-83.5854], [9.515,-84.247], [10.249,-84.424], [9.6689,-83.6706], [10.366,-84.288], [10.266,-84.416], [9.529,-83.821], [10.369,-84.293], [9.5476,-84.3307], [9.464,-84.013], [10.067,-83.581], [10.3585,-84.3263], [9.4778,-84.2003], [10.3537,-84.3427], [9.888,-84.551], [10.0803,-83.5729], [9.469,-84.216], [9.4405,-84.0855], [9.756,-83.585], [9.44,-84.12], [9.5239,-83.7653], [9.484,-83.833], [9.5309,-83.7524], [9.465,-84.252], [9.5195,-83.7533], [9.4976,-83.7866], [9.46,-84.258], [9.4254,-84.1348], [10.0555,-84.5759], [9.909,-83.527], [9.4461,-83.8815], [9.5099,-83.755], [9.4452,-83.8811], [9.4923,-83.7804], [9.424,-83.953], [9.5064,-83.7543], [9.4187,-84.1385], [9.42,-84.15], [10.25,-84.5], [9.8578,-84.59], [9.47,-83.8], [9.48,-83.78], [9.443,-84.258], [9.41,-84.141], [9.414,-84.164], [10.193,-84.544], [9.487,-84.349], [9.907,-84.6025], [9.4571,-83.8138], [10.0387,-84.5972], [10.0433,-84.6], [10.0542,-83.5135], [9.435,-83.8455], [9.4019,-84.1553], [9.3889,-84.0209], [9.4175,-83.8674], [9.48,-83.73], [9.4458,-83.7847], [9.536,-83.66], [9.6824,-84.5636], [9.517,-83.68], [9.41,-83.86], [9.5616,-84.486], [9.3971,-83.8778], [9.524,-83.661], [10.04,-84.63], [9.4852,-83.704], [9.3941,-83.8778], [9.5,-83.683], [9.562,-83.618], [9.845,-84.632], [9.399,-84.261], [9.501,-83.677], [9.5,-83.678], [9.464,-83.712], [9.455,-83.721], [9.4871,-83.6777], [10.121,-84.631], [9.4979,-83.6591], [9.5932,-84.544], [9.41,-84.329], [9.8712,-83.457], [9.425,-83.751], [9.506,-84.4713], [9.8742,-83.4535], [9.34,-84.08], [9.353,-84.19], [9.426,-84.376], [10.263,-84.583], [9.4328,-84.3929], [9.461,-83.68], [10.275,-84.587], [9.379,-84.3112], [9.439,-83.695], [9.4244,-83.7159], [9.6203,-84.5891], [9.5,-83.62], [9.4287,-83.7066], [10.322,-84.56], [10.2868,-84.5846], [9.4317,-83.6936], [9.592,-84.584], [9.331,-84.214], [10.3,-84.59], [9.3163,-83.9503], [9.575,-84.578], [9.6113,-84.6041], [9.3946,-83.7255], [9.4102,-83.7003], [9.3406,-83.8373], [9.3556,-83.7892], [9.314,-84.2], [9.3242,-83.8599], [9.422,-84.45], [9.3132,-83.878], [9.54,-84.58], [9.6162,-84.6338], [10.5839,-83.8584], [9.4162,-83.6553], [9.782,-84.702], [9.4,-83.6755], [9.2979,-83.9033], [9.2979,-83.9033], [9.4373,-83.6255], [9.4408,-84.4993], [9.2981,-83.8775], [9.4411,-84.5055], [9.28,-84.182], [9.479,-84.5656], [9.6578,-84.6863], [9.5895,-84.6526], [9.4684,-84.5605], [9.4316,-84.5302], [9.436,-84.539], [10.455,-84.548], [10.2294,-84.7056], [9.362,-84.461], [9.4187,-84.5332], [9.992,-83.345], [9.342,-84.433], [10.57,-84.41], [9.4794,-84.5994], [9.969,-83.336], [10.15,-84.75], [9.46,-84.59], [9.214,-84.066], [9.31,-84.42], [9.405,-84.556], [9.2112,-84.1284], [9.3692,-84.5188], [9.9436,-83.3147], [9.3129,-84.4533], [9.2221,-84.2406], [9.2221,-84.2406], [9.53,-84.68], [9.3906,-84.5639], [9.3143,-83.6478], [9.4103,-84.5887], [9.443,-84.621], [10.44,-84.633], [9.322,-84.485], [9.5228,-84.6862], [9.189,-84.09], [9.485,-84.662], [9.3916,-84.5864], [9.4943,-84.6767], [9.3954,-84.5961], [9.18,-84.14], [9.439,-84.643], [9.75,-84.81], [9.206,-84.294], [9.1676,-84.0898], [10.127,-84.818], [10.3287,-84.7432], [9.26,-83.675], [9.18,-83.88], [9.1844,-83.8583], [9.6,-84.766], [9.3784,-84.6045], [9.2303,-83.722], [9.203,-83.784], [9.2806,-83.6255], [9.16,-84.16], [9.3726,-84.6096], [9.1929,-83.7966], [9.4,-84.643], [9.618,-84.794], [10,-83.25], [9.401,-84.652], [9.418,-84.668], [10.024,-84.863], [10.1638,-84.838], [9.5583,-84.7742], [9.1331,-84.1372], [9.133,-84.141], [9.634,-84.815], [9.385,-84.6546], [9.3605,-84.6306], [9.6103,-84.8071], [9.597,-84.804], [9.1265,-84.1419], [9.579,-84.801], [9.41,-84.69], [9.12,-84.15], [9.631,-84.828], [9.1188,-84.1569], [10.7133,-83.7181], [10.2786,-84.8257], [9.3,-83.52], [9.684,-84.857], [10.25,-84.85], [9.618,-84.839], [10.716,-83.6868], [10.197,-84.874], [9.68,-84.87], [10.2664,-84.8538], [9.126,-83.799], [10.439,-84.7662], [9.661,-84.871], [9.307,-84.6356], [10.3107,-84.8422], [9.084,-83.947], [9.085,-83.928], [9.326,-84.67], [9.5238,-84.8247], [10.0217,-84.933], [10.5122,-84.7329], [9.61,-84.87], [10.2512,-84.8837], [9.937,-84.938], [10.7423,-83.6719], [9.9626,-83.1717], [9.605,-84.874], [9.38,-83.376], [9.23,-83.53], [9.69,-84.91], [9.054,-84.108], [9.562,-84.87], [9.549,-84.865], [9.9194,-84.9595], [9.0462,-84.1188], [9.542,-84.865], [10.5491,-84.7351], [9.04,-84.13], [9.5,-84.85], [9.527,-84.865], [9.51,-84.856], [9.388,-83.335], [9.5342,-84.8719], [9.0294,-84.1199], [9.491,-84.8605], [9.504,-84.868], [9.5056,-84.8707], [9.61,-84.92], [9.4952,-84.8677], [9.0217,-83.9723], [9.508,-84.878], [9.012,-84.076], [9.6542,-84.9473], [9.0116,-83.9408], [9.8763,-83.1138], [9.0019,-83.9692], [9.0595,-83.7181], [8.9954,-84.0284], [10.097,-83.114], [8.994,-83.993], [9.633,-84.961], [9.6579,-84.9694], [8.9932,-83.9652], [9.469,-84.891], [9.572,-84.949], [8.982,-84.126], [8.981,-83.97], [9.364,-83.274], [9.347,-83.286], [9.366,-83.268], [9.36,-83.27], [10.037,-85.035], [9.355,-83.272], [8.971,-84.191], [9.33,-83.2865], [8.963,-83.906], [9.36,-83.25], [8.965,-84.232], [9.845,-85.05], [8.9477,-84.0689], [9.9243,-83.0524], [9.349,-83.249], [9.2639,-84.7958], [9.584,-84.996], [9.018,-83.669], [10.6358,-84.7997], [10.3971,-84.968], [8.9283,-84.1076], [9.49,-84.97], [9.619,-85.028], [9.613,-85.028], [8.93,-84.23], [9.548,-85.014], [9.608,-85.039], [8.9115,-84.1357], [8.911,-84.13], [9.7442,-85.0767], [8.9364,-84.3018], [9.582,-85.032], [9.602,-85.04], [9.591,-85.039], [9.591,-85.0395], [9.591,-85.0395], [9.59,-85.04], [9.616,-85.051], [10.599,-84.879], [9.668,-85.08], [9.677,-85.083], [9.697,-85.0884], [8.884,-84.126], [10.458,-83.118], [10.504,-83.137], [9.978,-82.98], [9.485,-85.03], [8.87,-84.14], [9.665,-85.103], [9.233,-84.872], [10.64,-84.9], [9.83,-82.967], [8.8503,-84.1136], [9.536,-85.082], [9.87,-82.953], [10.594,-84.956], [10.512,-83.097], [9.608,-85.122], [10.638,-84.943], [10.056,-85.179], [10.409,-85.091], [9.2415,-83.17], [9.6005,-85.1407], [10.622,-84.9754], [8.8177,-83.8976], [10.66,-84.949], [9.2439,-83.1559], [10.6463,-84.9653], [10.6421,-84.9687], [10.645,-84.972], [9.568,-85.148], [10.643,-84.984], [9.5999,-85.164], [10.652,-84.981], [10.6329,-84.9969], [9.553,-85.154], [10.639,-85.001], [10.629,-85.009], [10.6389,-85.003], [9.823,-82.889], [10.777,-84.889], [10.007,-82.853], [10.6879,-85.0097], [9.634,-85.222], [9.65,-82.887], [9.597,-85.222], [9.647,-82.87], [9.589,-85.228], [10.3358,-85.2206], [8.79,-83.644], [9.6267,-82.8647], [10.708,-85.0314], [9.68,-85.268], [9.954,-82.812], [10.683,-85.066], [10.1781,-85.297], [10.095,-85.31], [10.147,-85.312], [10.7659,-85.0306], [10.027,-85.326], [8.6763,-84.0968], [10.7535,-85.05], [10.7773,-85.0331], [10.161,-85.32], [9.8494,-82.7785], [10.7675,-85.0471], [9.248,-82.972], [10.168,-85.334], [10.2786,-85.312], [10.7911,-85.044], [10.744,-85.0853], [10.7752,-85.0608], [9.4045,-85.2413], [10.7865,-85.0553], [10.154,-85.347], [10.11,-85.358], [10.7402,-85.1145], [10.152,-85.3633], [10.71,-85.14], [10.366,-85.323], [10.675,-85.177], [10.679,-85.176], [10.6817,-85.1743], [10.771,-85.111], [10.668,-85.186], [8.86,-83.27], [10.67,-85.189], [10.782,-85.11], [10.165,-85.3883], [10.7472,-85.1446], [10.7702,-85.1349], [10.5887,-85.2525], [8.71,-83.5], [9.0005,-83.0786], [10.582,-85.264], [9.86,-85.42], [10.8113,-85.1165], [10.7153,-85.1887], [10.6904,-85.2071], [9.314,-82.835], [10.8611,-85.0883], [10.699,-85.213], [10.8344,-85.1145], [10.31,-85.392], [10.8191,-85.1337], [10.0263,-85.4457], [10.724,-85.214], [10.71,-85.23], [9.918,-85.46], [9.7321,-82.6671], [10.827,-85.166], [9.8366,-85.468], [10.789,-85.1995], [9.7801,-85.4679], [9.916,-85.48], [9.4559,-85.3929], [8.9875,-85.1105], [9.9699,-85.4826], [8.8187,-83.1805], [9.958,-85.503], [9.855,-85.502], [9.763,-85.496], [9.328,-82.742], [9.696,-85.49], [9.319,-82.7429], [8.684,-83.329], [8.6678,-83.3396], [10.217,-85.501], [9.266,-85.358], [9.958,-85.5276], [10.213,-85.509], [9.9728,-85.539], [8.888,-83.014], [8.93,-82.968], [8.5045,-83.6802], [9.8471,-85.5544], [8.884,-82.989], [8.66,-83.27], [8.457,-84.2957], [9.991,-85.567], [10.525,-85.4555], [9.7887,-85.5617], [9.743,-82.556], [10.03,-85.57], [9.9616,-85.5729], [9.972,-85.579], [9.69,-82.551], [8.7464,-83.1122], [8.9432,-82.8974], [9.7281,-85.5751], [9.885,-85.597], [9.981,-85.598], [9.718,-85.586], [8.908,-82.912], [9.8655,-85.6027], [9.04,-82.8], [10.1844,-85.5894], [8.73,-83.095], [8.836,-82.968], [8.7752,-83.0328], [8.84,-82.96], [10.11,-85.61], [9.956,-85.62], [9.861,-85.62], [9.931,-85.623], [8.657,-83.155], [9.975,-85.632], [10.0205,-85.6327], [9.688,-85.613], [8.534,-83.356], [9.973,-85.635], [8.707,-83.08], [8.607,-83.221], [9.962,-85.638], [9.966,-85.638], [9.968,-85.639], [9.9623,-85.6406], [9.955,-85.641], [9.95,-85.642], [10.023,-85.642], [10.075,-85.641], [8.8671,-82.8909], [8.528,-83.3407], [8.596,-83.216], [9.8292,-85.6455], [8.825,-82.926], [10,-85.65], [9.95447,-85.653], [9.932,-85.653], [8.605,-83.193], [9.9653,-85.6534], [9.906,-85.654], [9.9506,-85.6585], [8.77,-82.97], [9.951,-85.66], [9.99,-85.66], [8.6044,-83.1805], [9.94,-85.661], [8.5283,-83.3092], [8.5622,-83.2474], [8.566,-83.24], [9.9154,-85.6621], [8.52,-83.32], [8.5328,-83.2946], [9.9743,-85.6642], [8.883,-82.8519], [8.5331,-83.2913], [8.7665,-82.9643], [9.8613,-85.6663], [8.553,-83.248], [9.926,-85.67], [8.338,-83.945], [10.0987,-85.6649], [9.94,-85.672], [9.9222,-85.6724], [8.524,-83.292], [9.9475,-85.6755], [10.0855,-85.6699], [9.9742,-85.6759], [8.545,-83.247], [9.955,-85.678], [9.6996,-85.6593], [10.03,-85.68], [10.0791,-85.6778], [10.0909,-85.6787], [10.0909,-85.6787], [9.9657,-85.6855], [8.5571,-83.2088], [10.09,-85.682], [8.583,-83.158], [9.9275,-85.6937], [9.3631,-82.5271], [8.542,-83.212], [8.518,-83.248], [8.8634,-82.8207], [8.581,-83.142], [8.5264,-83.2293], [8.62,-83.08], [9.9226,-85.708], [8.5187,-83.2263], [10.1734,-85.6949], [8.4678,-83.319], [8.658,-83.02], [8.491,-83.271], [9.788,-85.709], [9.8233,-85.7235], [10.0826,-85.7263], [8.624,-83.024], [8.6413,-82.9909], [10.2,-85.73], [11.294,-83.02], [9.768,-85.746], [8.61,-83.0078], [9.877,-85.759], [10.1671,-85.7469], [8.553,-83.066], [8.685,-82.902], [10.651,-85.627], [8.646,-82.929], [8.636,-82.931], [10.0367,-85.7891], [8.48,-83.13], [8.4884,-83.1117], [8.433,-83.188], [8.467,-83.1306], [8.4821,-83.1011], [8.4815,-83.0994], [9.916,-85.809], [10.5795,-85.6945], [8.4734,-83.0985], [8.6664,-82.8498], [8.6755,-82.839], [8.6796,-82.8332], [8.672,-82.837], [10.4139,-85.7773], [8.391,-83.174], [8.41,-83.14], [9.785,-85.854], [10.2,-85.847], [8.648,-82.798], [8.6612,-82.7834], [8.4321,-83.0661], [8.418,-83.085], [8.383,-83.14], [8.1343,-84.0329], [10.5315,-85.7749], [9.12,-82.44], [10.4898,-85.7973], [9.51,-85.832], [10.299,-85.854], [10.648,-85.752], [8.1932,-83.5205], [8.45,-82.99], [8.357,-83.117], [10.1126,-85.9055], [10.4849,-85.8339], [8.46,-82.946], [10.262,-85.889], [9.518,-85.867], [8.305,-83.155], [8.338,-83.096], [8.378,-83.031], [9.496,-85.88], [8.3467,-83.0678], [10.2783,-85.9138], [8.1502,-83.4813], [8.91,-82.48], [8.273,-83.181], [8.284,-83.144], [10.16,-85.943], [8.284,-83.141], [10.3896,-85.906], [8.675,-82.637], [8.29,-83.107], [8.4333,-82.8879], [9.145,-85.818], [8.3167,-83.0029], [10.094,-85.994], [10.056,-85.998], [10.3063,-85.9708], [8.3641,-82.9101], [8.13,-83.336], [8.323,-82.944], [10.1226,-86.0214], [8.11,-83.34], [8.249,-83.035], [8.4059,-82.8075], [8.2433,-83.0335], [10.039,-86.046], [8.357,-82.842], [8.338,-82.865], [8.4782,-82.6947], [9.4276,-85.9918], [8.4185,-82.7572], [8.7007,-82.4842], [8.196,-83.058], [8.3268,-82.8551], [8.215,-83.001], [8.27,-82.914], [10.027,-86.087], [8.202,-83.002], [8.268,-82.891], [8.319,-82.815], [8.335,-82.787], [8.305,-82.823], [8.256,-82.886], [8.298,-82.82], [11.08,-85.79], [8.2512,-82.8636], [8,-83.329], [8.263,-82.816], [10.5536,-86.0663], [8.2501,-82.8182], [11.154,-85.78], [8.1509,-82.946], [9.506,-86.1407], [8.19,-82.85], [8.18,-82.86], [8.078,-82.986], [9.928,-86.216], [8.2782,-82.685], [10.404,-86.177], [11.1361,-85.8722], [10.3947,-86.1802], [8.0847,-82.9389], [8.119,-82.843], [10.0541,-86.2499], [10.1961,-86.2562], [10.286,-86.247], [10.253,-86.253], [10.27,-86.253], [10.947,-86.043], [10.3142,-86.25], [8.2378,-82.6307], [8.097,-82.818], [10.3747,-86.2454], [8.2215,-82.6393], [8.032,-82.88], [10.347,-86.2779], [10.3154,-86.2872], [10.336,-86.289], [10.3712,-86.2833], [11.226,-85.93], [10.448,-86.269], [10.3399,-86.304], [8.151,-82.65], [10.4,-86.31], [7.913,-82.982], [11.4921,-85.7634], [7.9398,-82.8865], [7.818,-83.099], [8.2,-85.632], [10.36,-86.377], [8.0166,-82.7], [10.361,-86.393], [7.8521,-82.9157], [11.538,-85.854], [10.6588,-86.3698], [10.488,-86.424], [10.536,-86.429], [7.8108,-82.852], [10.5564,-86.4359], [10.631,-86.437], [10.8068,-86.3796], [7.8211,-82.7518], [7.694,-82.977], [7.6856,-82.8604], [11.62,-86.03], [11.313,-86.254], [7.546,-83.087], [11.6,-86.06], [10.8269,-86.5347], [10.2444,-86.6944], [10.874,-86.617], [7.5413,-82.7514], [7.6238,-82.5321], [7.58,-82.599], [10.561,-86.801], [11.595,-81.441], [11.751,-86.681], [11.725,-86.975], [6.55,-82.74], [6.613,-82.512], [6.5917,-82.4448], [5.856,-82.795], [12.448,-87.735], [5.661,-82.299], [12.576,-88.046], [11.9597,-88.8355], [13.01,-90.04], [17.5,83.6], [9.9636,83.8575] ]

		# definir registro
		#records = {"data": [{"lat":0, "long":0, "provincia":"", "distrito": "", "canton":""}] }
		records = {"data": []}

		# llenar registros basado en el Geocoder.search
		result = nil
		puts "arr size is #{arr.size}"
		puts "arr at #{idx} is #{arr[idx.to_i]}"
		arr[idx.to_i..arr.size].each do |a|
		  result = Geocoder.search(a)
		  break if result.nil?
		  #break if result[0].nil?
		  provincia, canton, distrito = "" 
		  if !result.empty? 
			  provincia, canton, distrito = ubicame result[0].address_components
		  end
		  _hash = {"lat": a[0], "long": a[1], "provincia": provincia, "canton": canton, "distrito": distrito}
		  puts _hash
		  records[:data] << _hash
		end

	    puts "result is nil" if result.nil?
	    puts "result[0] is nill" if !result.nil? and result[0].nil?
	    
		# generar el CSV file
		file_name = "./off-files/data#{file_number}.csv"
		CSV.open(file_name, "w", :headers=>true) do |csv| #open new file for write
		  records[:data].each do |hash| #open json to parse
			csv << hash.values #write value to file
		  end
		end
		
		puts "Completed!"
	end 
end